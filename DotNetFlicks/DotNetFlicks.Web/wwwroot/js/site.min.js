function sortMovies(){var n=$(".dropdown-item.sort-movies.active").attr("id"),t=$("#sort-direction").attr("data-sort");tinysort("div.movie-column",{attr:n,order:t})}function initializePersonPicker(n){$(n+" .person-picker").selectpicker().ajaxSelectPicker({ajax:{url:"../../Movie/GetPersonSelectData",data:{query:"{{{q}}}"}}})}function initializeDepartmentPicker(n){$(n+" .department-picker").selectpicker().ajaxSelectPicker({ajax:{url:"../../Movie/GetDepartmentSelectData",data:{query:"{{{q}}}"}}})}function changeRowOrder(n,t){var i=n.find("input.order"),r=parseInt(i.val());i.val(r+t)}function initializeBootstrapTooltips(){$('[data-toggle="tooltip"]').tooltip()}$(function(){initializeBootstrapTooltips();$(".image-modal").on("show.bs.modal",function(n){var t=$(n.relatedTarget),r=t.data("title"),u=t.data("img-src"),i=$(this);i.find(".modal-title").text(r);i.find("img").attr("src",u)});$(".data-table").DataTable({stateSave:!0,fixedHeader:{headerOffset:$(".navbar").outerHeight()},drawCallback:initializeBootstrapTooltips()});$(".people-data-table").DataTable({stateSave:!0,fixedHeader:{headerOffset:$(".navbar").outerHeight()},serverSide:!0,autoWidth:!1,ajax:{url:"/Person/LoadData",type:"POST"},drawCallback:initializeBootstrapTooltips(),rowId:"Id",columns:[{className:"d-table-cell align-middle",data:"Name",render:function(n,t,i){return'<a href="Person/View/'+i.Id+'" class="custom-link">'+i.Name+"<\/a >"}},{className:"d-none d-md-table-cell align-middle",orderable:!1,render:function(n,t,i){return i.ImageUrl?'<button type="button" class="btn btn-secondary" data-toggle="modal" data-target=".image-modal" data-title="'+i.Name+'" data-img-src="'+i.ImageUrl+'"><i class="fas fa-image"><\/i><\/button>':""}},{className:"d-none d-md-table-cell",orderable:!0,data:"Roles.length",render:function(n,t,i){return'<button type="button" class="btn btn-secondary" data-toggle="tooltip" data-html="true" title="'+i.RolesTooltip+'">'+i.Roles.length+"<\/button >"}},{orderable:!1,render:function(n,t,i){return'<div class="d-flex"><a class="btn btn-primary ml-2" href="Person/Edit/'+i.Id+'"><i class="fas fa-edit"><\/i><\/a><a class="btn btn-primary ml-2" href="Person/Delete/'+i.Id+'"><i class="fas fa-trash"><\/i><\/a><\/div >'}}]});$("#Runtime").rules("remove","range");$(document).on("click",".sort-movies",function(){$(".dropdown-item.sort-movies.active").removeClass("active text-white");$(this).addClass("active text-white");$("#sort-movies-dropdown").text(this.text);sortMovies()});$("#sort-direction").on("click",function(){$(this).attr("data-sort",$(this).attr("data-sort")==="desc"?"asc":"desc");$(this).find("[data-fa-i2svg]").toggleClass("fa-arrow-up").toggleClass("fa-arrow-down");sortMovies()});$(".collapse-card").on("click",function(){$(this).find("[data-fa-i2svg]").toggleClass("fa-chevron-up").toggleClass("fa-chevron-down")});$("#cast-modal, #crew-modal").on("show.bs.modal",function(){initializePersonPicker("#"+$(this).attr("id"));$(this).is("#crew-modal")&&initializeDepartmentPicker("")});$("#cast-modal, #crew-modal").on("click",".add-person",function(){var n="#"+$(this).closest(".modal").attr("id"),t=n==="#cast-modal"?"../../Movie/AddCastMember":"../../Movie/AddCrewMember",i=$(n+" table tbody tr").length;$.ajax({url:t,data:{index:i},type:"GET"}).done(function(t){$(n+" table tbody").append(t);var i=n+" table tr:last";initializePersonPicker(i);n==="#crew-modal"&&initializeDepartmentPicker(i)})});$("#cast-table, #crew-table").on("click",".delete-person",function(){$(this).closest("td").find(".is-deleted").val("true");var n=$(this).closest("tr");n.hide();$(this).is("#cast-table")&&n.nextAll().each(function(n,t){changeRowOrder($(t),-1)})});$(".order-up, .order-down").click(function(){var n=$(this).closest("tr"),r=parseInt(n.find("input.order").val()),u=$("#crew-table tbody tr").length-1,t,i;$(this).is(".order-up")&&r!==0?(t=$(n).prevAll("tr:visible:first"),t.length&&(n.insertBefore(t),changeRowOrder(n,-1),changeRowOrder(t,1))):r!==u&&(i=$(n).nextAll("tr:visible:first"),i.length&&(n.insertAfter(i),changeRowOrder(n,1),changeRowOrder(i,-1)))})});